<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Truco Paulista ‚Ä¢ Jogo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: radial-gradient(circle at top, #1a1a1a, #000 70%);
  font-family: 'Poppins', Arial, sans-serif;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
}

#mesa {
  width: 380px;
  height: 600px;
  background: linear-gradient(180deg, #1e7f3b, #145c2a);
  border-radius: 20px;
  border: 4px solid #00ff88;
  box-shadow: 0 0 30px rgba(0,255,136,0.4);
  padding: 16px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.topo, .base {
  text-align: center;
  font-weight: bold;
}

.mesa-cartas {
  display: flex;
  justify-content: center;
  gap: 20px;
  min-height: 140px;
}

.carta {
  width: 80px;
  height: 120px;
  background: #fff;
  color: #000;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.2s;
}

.carta:hover {
  transform: translateY(-10px);
}

.carta.mesa {
  cursor: default;
}

.status {
  text-align: center;
  background: rgba(0,0,0,0.4);
  padding: 10px;
  border-radius: 10px;
  font-size: 16px;
}
</style>
</head>

<body>

<div id="mesa">
  <div class="topo">üßë Oponente</div>

  <div class="mesa-cartas" id="mesaCartas"></div>

  <div class="status" id="status">üîÑ Conectando...</div>

  <div class="mesa-cartas" id="minhasCartas"></div>

  <div class="base">üßë Voc√™</div>
</div>

<script>
const ws = new WebSocket("wss://truco-da-sorte.onrender.com");

const status = document.getElementById("status");
const minhasCartasDiv = document.getElementById("minhasCartas");
const mesaCartasDiv = document.getElementById("mesaCartas");

let minhasCartas = [];
let minhaVez = false;

ws.onopen = () => {
  status.innerHTML = "üîå Conectado, aguardando jogo...";
};

ws.onmessage = (msg) => {
  const data = JSON.parse(msg.data);

  if (data.type === "START_GAME") {
    status.innerHTML = "üÉè Jogo iniciado!";
  }

  if (data.type === "HAND") {
    minhasCartas = data.cartas;
    renderizarCartas();
  }

  if (data.type === "YOUR_TURN") {
    minhaVez = true;
    status.innerHTML = "üëâ Sua vez de jogar";
  }

  if (data.type === "OPPONENT_PLAY") {
    mostrarCartaMesa(data.carta);
    status.innerHTML = "‚è≥ Vez do oponente";
  }
};

function renderizarCartas() {
  minhasCartasDiv.innerHTML = "";
  minhasCartas.forEach((carta, index) => {
    const div = document.createElement("div");
    div.className = "carta";
    div.innerHTML = carta;
    div.onclick = () => jogarCarta(index);
    minhasCartasDiv.appendChild(div);
  });
}

function jogarCarta(index) {
  if (!minhaVez) return;

  const carta = minhasCartas[index];
  minhasCartas.splice(index, 1);
  renderizarCartas();

  mostrarCartaMesa(carta);

  ws.send(JSON.stringify({
    type: "PLAY_CARD",
    carta
  }));

  minhaVez = false;
  status.innerHTML = "‚è≥ Vez do oponente";
}

function mostrarCartaMesa(carta) {
  mesaCartasDiv.innerHTML = "";
  const div = document.createElement("div");
  div.className = "carta mesa";
  div.innerHTML = carta;
  mesaCartasDiv.appendChild(div);
}
</script>

</body>
</html>
